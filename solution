const STORAGE_KEY = 'tab-alive';
    const TAB_ID = Date.now() + '_' + Math.random();

    let isDuplicate = false;

    function notifyOtherTabs() {
      // Trigger other tabs to respond
      localStorage.setItem('tab-ping', TAB_ID);
    }

    function handleStorageEvent(e) {
      if (e.key === 'tab-ping') {
        // Another tab is asking if anyone's alive
        // Respond with our own ID
        localStorage.setItem(STORAGE_KEY, TAB_ID);
      } else if (e.key === STORAGE_KEY && e.newValue !== TAB_ID) {
        // We received a response: another tab is alive
        isDuplicate = true;
        alert('Duplicate tab detected (this tab is the duplicate)');
      }
    }

    window.addEventListener('storage', handleStorageEvent);

    // Step 1: Ping other tabs
    notifyOtherTabs();

    // Step 2: Wait briefly to see if someone responds
    setTimeout(() => {
      if (!isDuplicate) {
        // No one responded â€” we're the first tab
        localStorage.setItem(STORAGE_KEY, TAB_ID);
      }
    }, 300); // 300ms is usually enough for round-trip communication
